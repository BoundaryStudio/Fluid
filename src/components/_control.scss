//
// Control
//
// Used to combine different components and objects into one control
// The main control needs to be the first child of Control class to work properly

label.control {
  > label {
    pointer-events: none;
  }
}

.control {
  position: relative;
  display: block;
  cursor: pointer;
  margin-top: 2.25px;
  margin-bottom: 2.25px;
  @include fontsize(1rem);

  //
  // Input Control
  //
  > .input {
    @include fontsize(inherit);
    height: 100%;
    margin: 0; // remove margin from input and apply it to the control class
  }

  &.has-icon-left {
    > .input {
      ~ .icon {
        z-index: $group-items-hover-focus-zindex + 1;
        pointer-events: none;
        opacity: $control-input-icon-opacity;
      }

      @include focus {
        ~ .icon {
          opacity: 1;
        }
      }
    }
  }

  &.has-floating-label > .input[placeholder=" "] {
    background-color: transparent;
    box-shadow: none;

    ~ label {
      position: absolute;
      top: 50%;
      left: strip-unit($controls-padding-x) * 1rem;
      transform: translateY(-50%);
      pointer-events: none;
      padding: 2px;
      background: $body-background;
      line-height: 1;
      @include transition(top, font-size);
    }

    @include focus(":not(:placeholder-shown)") {
      ~ label {
        top: 0%;
        @include font-size($default-small-quantity * 1em);
      }
    }
  }

  //
  // Radio Control
  //
  > .radio {
    &:checked {
      ~ label {
        @include before {
          border: $control-radio-checked-borderwidth solid;
        }
      }
    }

    ~ label {
      @include before {
        border-radius: border-radius(50%, 0);
      }
    }
  }

  //
  // Checkbox Control
  //
  > .checkbox {
    &:checked {
      ~ label {
        @include before {
          background: currentColor;
        }

        @include after {
          top: 46.4%;
          transform: translate(-50%, -50%) rotate(45deg);
          width: $control-radio_checkbox-size / 4;
          height: $control-radio_checkbox-size / 2;
          border: 2px solid $white;
          border-top-width: 0;
          border-left-width: 0;
        }
      }
    }

    &:indeterminate {
      ~ label {
        @include before {
          border-color: currentColor;
          background: currentColor;
        }

        @include after {
          content: "";
          position: absolute;
          top: 50%;
          transform: translate(-50%, -50%);
          width: 8px;
          height: 2px;
          background: #fff;
        }
      }
    }

    ~ label {
      @include after {
        content: "";
        position: absolute;
        left: $control-radio_checkbox-size / 2;
      }
    }
  }

  //
  // Radio / Checkbox shared Control
  //
  > .checkbox,
  > .radio {
    @extend %controls-hide;

    @include focus {
      ~ label {
        @include before {
          @include animation(pulse); // pulse animation on click event
        }
      }
    }

    @include active(":checked") {
      ~ label {
        @include before {
          border-color: currentColor;
        }
      }
    }

    ~ label {
      cursor: pointer;
      padding-left: $control-radio_checkbox-paddingleft;
      margin-bottom: 0; // override label margin bottom inside control

      @include before {
        @extend %controls;
        content: "";
        position: absolute;
        top: 50%;
        left: 0;
        transform: translateY(-50%);
        width: $control-radio_checkbox-size;
        height: $control-radio_checkbox-size;
        padding: 0; // override controls padding
        margin: 0; // override controls margin
        border-color: $control-radio_checkbox-bordercolor;
        background-color: $control-radio_checkbox-background;
      }
    }

    //
    // Radio / Checkbox Color variants
    //
    @each $color, $value in $theme-colors {
      &.is-#{$color} {
        ~ label {
          @include before {
            color: $value;
          }
        }
      }
    }

    @include disabled {
      ~ label {
        @extend %controls-disabled;
        @include before {
          color: $controls-theme-light;
        }
      }
    }
  }

  //
  // feedback inside control
  //
  > .feedback {
    position: absolute;
    right: 0;
    bottom: 100%;
    display: none;
    padding: $control-input-feedback-padding;
    margin-bottom: $control-input-feedback-arrow-size + $control-input-feedback-offset-bottom;
    border-radius: border-radius();
    color: $control-input-feedback-color;
    box-shadow: box-shadow($control-input-feedback-shadow);
    @include gradient-bg($control-input-feedback-background, 180deg);

    @include before {
      content: "";
      position: absolute;
      right: $control-input-feedback-arrow-offset-right;
      bottom: -($control-input-feedback-arrow-size * 2);
      @include triangle(bottom, $control-input-feedback-arrow-size, $control-input-feedback-background);
    }
  }

  &.is-valid > .feedback.is-valid {
    @extend %display-block;
  }

  &.is-invalid > .feedback.is-invalid {
    @extend %display-block;
  }
}

.is-validated .control {
  > .input:required {
    &:valid ~ .feedback.is-valid {
      @extend %display-block;
    }
    &:invalid ~ .feedback.is-invalid {
      @extend %display-block;
    }
  }
}
